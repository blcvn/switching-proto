syntax = "proto3";

// Package định nghĩa các message dùng chung cho offchain services
package offchain.v1;

import "google/protobuf/timestamp.proto";
import "offchain/error.proto";

option go_package = "github.com/blcvn/switching-proto/go/offchain;offchain";
option java_package = "com.blcvn.switching.offchain";

// Các message dùng chung cho các service cụ thể trong offchain

// Message rỗng, dùng cho các RPC không cần tham số đầu vào
message Empty {}

// Thông tin thanh toán
message Payment {
  string id = 1;                              // ID định danh thanh toán
  string uetr = 2;                            // Unique End-to-End Transaction Reference
  double amount = 3;                          // Số tiền thanh toán
  string currency = 4;                        // Mã tiền tệ (ví dụ: USD, VND)
  string debtor_agent = 5;                    // BIC của ngân hàng người gửi
  string creditor_agent = 6;                  // BIC của ngân hàng người nhận
  string end_to_end_id = 7;                  // ID định danh end-to-end của giao dịch
  string status = 8;                         // Trạng thái thanh toán
  google.protobuf.Timestamp created_at = 9;  // Thời gian tạo thanh toán
  // Thông tin tài khoản chi tiết của ngân hàng người gửi (tùy chọn)
  Account debtor_agent_account = 10;
  // Thông tin tài khoản chi tiết của ngân hàng người nhận (tùy chọn)
  Account creditor_agent_account = 11;
  string transaction_reference = 12;          // Mã tham chiếu giao dịch
}

// Thông tin chuyển tiền giữa các tổ chức tài chính
message Transfer {
  string instruction_id = 1;                  // ID của lệnh chuyển tiền
  string debtor = 2;                          // BIC của ngân hàng người gửi
  string creditor = 3;                        // BIC của ngân hàng người nhận
  double amount = 4;                          // Số tiền chuyển
  string currency = 5;                       // Mã tiền tệ
  string status = 6;                         // Trạng thái chuyển tiền
  google.protobuf.Timestamp created_at = 7;   // Thời gian tạo lệnh chuyển
  // Thông tin tài khoản chi tiết của người gửi (tùy chọn)
  Account debtor_account = 8;
  // Thông tin tài khoản chi tiết của người nhận (tùy chọn)
  Account creditor_account = 9;
}

// Thông tin thực thể KYC (Know Your Customer)
message KycEntity {
  string bic = 1;          // Bank Identifier Code
  string name = 2;         // Tên tổ chức
  string country = 3;      // Mã quốc gia
  string lei = 4;          // Legal Entity Identifier
  string updated_at = 5;   // Thời gian cập nhật lần cuối
  string access_point_url = 6;  // URL của access point
  string balance = 7;      // Số dư trong smart contract
}

// Thông tin chi tiết tài khoản liên kết với một agent
message Account {
  // Số tài khoản quốc tế IBAN (nếu có)
  string iban = 1;
  // Số tài khoản nội địa
  string account_number = 2;
  // Tên chủ tài khoản
  string account_name = 3;
  // Mã tiền tệ của tài khoản (tùy chọn)
  string currency = 4;
  // Thông tin tham chiếu hoặc định danh bổ sung (ví dụ: ID phụ)
  string reference = 5;
}

// Metadata chứa thông tin về request/response
message Metadata {
  string request_id = 1;    // ID định danh duy nhất cho request
  int64 request_time = 2;   // Thời gian gửi request (Unix timestamp)
  string version = 3;       // Phiên bản của protocol
}

// Signature định nghĩa cấu trúc chữ ký số cho request/response
message Signature {
  // SignatureType định nghĩa các loại chữ ký được hỗ trợ
  enum SignatureType {
      NO_USE_TYPE = 0;  // Giá trị mặc định, không sử dụng
      J = 1;            // Chữ ký loại J
      C = 2;            // Chữ ký loại C
      S = 3;            // Chữ ký loại S
  }
  SignatureType s_type = 1;  // Loại chữ ký được sử dụng
  string s = 2;              // Chuỗi dữ liệu dùng để tạo ra chữ ký
  bytes b = 3;               // Chữ ký số (dạng bytes)
}

// Result định nghĩa cấu trúc kết quả trả về
message Result {
  ResultCode code = 1;     // Mã kết quả thực thi (enum)
  string message = 2;     // Thông điệp mô tả kết quả
}